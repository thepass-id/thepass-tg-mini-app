import a from "async-retry";
import { safeParseAndWarn as o } from "./schemas.js";
async function c(n, i, s = { retries: 5, minTimeout: 5e3 }) {
  return a(async (t) => {
    let e = null;
    try {
      e = await n();
    } catch {
      return t(new Error("Error fetching")), null;
    }
    const r = o(i, e);
    if (!r.success)
      return t(new Error("Error parsing response")), null;
    if (r.data.status !== "initialised")
      throw new Error("Not initialised yet");
    return r.data;
  }, s);
}
export {
  c as retryUntilInitialised
};
