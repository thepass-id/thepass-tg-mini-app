import { isEmpty as f } from "lodash-es";
import { normalizeActivitySummaryCollection as y } from "../normalize.js";
import { nativeActivitySchema as v, NativeActivityTypeNative as u } from "../schema.js";
function S(t) {
  var n, o;
  const a = (o = (n = t.transactions) == null ? void 0 : n[0].reviewOfTransaction) == null ? void 0 : o.reviews;
  return a ? a.map((c) => c.action) : void 0;
}
function z({ simulateAndReview: t, ...a }) {
  var n, o, c;
  const r = {
    type: u,
    ...a
  };
  if (t && !f(t.transactions)) {
    const i = (n = t.transactions) == null ? void 0 : n[t.transactions.length - 1], s = (o = i == null ? void 0 : i.simulation) == null ? void 0 : o.summary;
    if (s) {
      const p = y(s);
      r.transferSummary = p;
    }
    const e = (c = i == null ? void 0 : i.reviewOfTransaction) == null ? void 0 : c.targetedDapp;
    e && (r.dapp = e);
    const m = S(t);
    m && (r.actions = m);
  }
  return v.parse(r);
}
export {
  z as createNativeActivity,
  S as normalizeActions
};
