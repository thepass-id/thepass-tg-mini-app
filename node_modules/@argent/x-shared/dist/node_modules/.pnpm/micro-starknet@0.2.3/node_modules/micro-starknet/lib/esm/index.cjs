"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("../../../../../@noble_hashes@1.3.3/node_modules/@noble/hashes/esm/sha3.cjs"),w=require("../../../../../@noble_hashes@1.3.3/node_modules/@noble/hashes/esm/sha256.cjs"),S=require("../../../../../@noble_hashes@1.3.3/node_modules/@noble/hashes/esm/utils.cjs"),c=require("../../../../../@noble_curves@1.0.0/node_modules/@noble/curves/esm/abstract/modular.cjs"),N=require("../../../../../@noble_curves@1.0.0/node_modules/@noble/curves/esm/abstract/poseidon.cjs"),F=require("../../../../../@noble_curves@1.0.0/node_modules/@noble/curves/esm/abstract/weierstrass.cjs"),i=require("../../../../../@noble_curves@1.0.0/node_modules/@noble/curves/esm/abstract/utils.cjs"),R=require("../../../../../@noble_curves@1.0.0/node_modules/@noble/curves/esm/_shortw_utils.cjs"),p=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),E=252;function g(e){for(;e[0]===0;)e=e.subarray(1);const n=e.length*8-E,t=i.bytesToNumberBE(e);return n>0?t>>BigInt(n):t}function m(e){return typeof e=="string"&&(e=_(e),e.length&1&&(e="0"+e)),i.hexToBytes(e)}const b=F.weierstrass({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:c.Field(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:p,nBitLength:E,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...R.getHash(w.sha256),bits2int:g,bits2int_modN:e=>{const n=i.bytesToNumberBE(e).toString(16);return n.length===63&&(e=m(n+"0")),c.mod(g(e),p)}});function T(e){return i.ensureBytes("",typeof e=="string"?m(e):e)}const{ProjectivePoint:u}=b;function v(e){return`0x${i.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function _(e){return e.replace(/^0x/i,"")}const a=[new u(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new u(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new u(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new u(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new u(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function y(e,n){const t=[];let r=e;for(let o=0;o<248;o++)t.push(r),r=r.double();r=n;for(let o=0;o<4;o++)t.push(r),r=r.double();return t}const q=y(a[1],a[2]),x=y(a[3],a[4]);function k(e){let n;if(typeof e=="bigint")n=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);n=BigInt(e)}else n=i.bytesToNumberBE(T(e));if(!(0n<=n&&n<b.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${n}`);return n}function B(e,n,t){let r=k(n);for(let o=0;o<252;o++){const s=t[o];if(s.equals(e))throw new Error("Same point");(r&1n)!==0n&&(e=e.add(s)),r>>=1n}return e}function $(e,n){let t=a[0];return t=B(t,e,q),t=B(t,n,x),v(t.toRawBytes(!0))}const D=i.bitMask(250),O=e=>i.bytesToNumberBE(h.keccak_256(e))&D;c.Field(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));const I=c.Field(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function j(e,n,t){const r=e.fromBytes(w.sha256(S.utf8ToBytes(`${n}${t}`)));return e.create(r)}const A=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function P(e,n){if(c.validateField(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);const t=e.rate+e.capacity,r=e.roundsFull+e.roundsPartial,o=[];for(let l=0;l<r;l++){const f=[];for(let d=0;d<t;d++)f.push(j(e.Fp,"Hades",t*l+d));o.push(f)}const s=N.poseidon({...e,t,sboxPower:3,reversePartialPowIdx:!0,mds:n,roundConstants:o});return s.m=t,s.rate=e.rate,s.capacity=e.capacity,s}P({Fp:I,rate:2,capacity:1,roundsFull:8,roundsPartial:83},A);exports.Fp251=I;exports.ProjectivePoint=u;exports.keccak=O;exports.pedersen=$;exports.poseidonBasic=P;
