"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const b=require("./modular.cjs"),m=require("./utils.cjs");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const O=BigInt(0),u=BigInt(1);function A(o,p){const w=(t,e)=>{const n=e.negate();return t?n:e},g=t=>{const e=Math.ceil(p/t)+1,n=2**(t-1);return{windows:e,windowSize:n}};return{constTimeNegate:w,unsafeLadder(t,e){let n=o.ZERO,a=t;for(;e>O;)e&u&&(n=n.add(a)),a=a.double(),e>>=u;return n},precomputeWindow(t,e){const{windows:n,windowSize:a}=g(e),s=[];let i=t,d=i;for(let c=0;c<n;c++){d=i,s.push(d);for(let l=1;l<a;l++)d=d.add(i),s.push(d);i=d.double()}return s},wNAF(t,e,n){const{windows:a,windowSize:s}=g(t);let i=o.ZERO,d=o.BASE;const c=BigInt(2**t-1),l=2**t,B=BigInt(t);for(let f=0;f<a;f++){const h=f*s;let r=Number(n&c);n>>=B,r>s&&(r-=l,n+=u);const N=h,S=h+Math.abs(r)-1,F=f%2!==0,I=r<0;r===0?d=d.add(w(F,e[N])):i=i.add(w(I,e[S]))}return{p:i,f:d}},wNAFCached(t,e,n,a){const s=t._WINDOW_SIZE||1;let i=e.get(t);return i||(i=this.precomputeWindow(t,s),s!==1&&e.set(t,a(i))),this.wNAF(s,i,n)}}}function y(o){return b.validateField(o.Fp),m.validateObject(o,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...b.nLength(o.n,o.nBitLength),...o,p:o.Fp.ORDER})}exports.validateBasic=y;exports.wNAF=A;
